{% extends 'base_hentai_modern.html' %}
{% load static %}

{% block title %}Restablecer Contrase√±a - LUSTPLACE{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-md w-full space-y-8">
        <!-- Card principal -->
        <div class="bg-gradient-to-br from-slate-900/90 to-purple-900/90 backdrop-blur-xl rounded-3xl shadow-2xl border border-purple-500/20 p-8">
            <!-- Icono y t√≠tulo -->
            <div class="text-center mb-8">
                <div class="mx-auto w-20 h-20 bg-gradient-to-br from-purple-600 to-orange-600 rounded-full flex items-center justify-center mb-4 shadow-lg animate-pulse">
                    <i class="fas fa-key text-3xl text-white"></i>
                </div>
                <h2 class="text-3xl font-extrabold bg-gradient-to-r from-purple-400 to-orange-400 bg-clip-text text-transparent">
                    ¬øOlvidaste tu contrase√±a?
                </h2>
                <p class="mt-2 text-gray-400">
                    No te preocupes, te ayudaremos a recuperarla
                </p>
            </div>

            <!-- Formulario -->
            <form id="password-reset-form" class="space-y-6">
                {% csrf_token %}

                <!-- Campo de email -->
                <div>
                    <label for="email" class="block text-sm font-semibold text-purple-400 mb-2">
                        <i class="fas fa-envelope mr-2"></i>Correo Electr√≥nico
                    </label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                            <i class="fas fa-at text-gray-500"></i>
                        </div>
                        <input 
                            type="email" 
                            name="email" 
                            id="email"
                            class="w-full pl-12 pr-4 py-3 bg-slate-900/50 border border-purple-500/20 rounded-2xl text-white placeholder-gray-500 focus:border-orange-400 focus:outline-none focus:ring-2 focus:ring-orange-400/20 transition-all duration-300"
                            placeholder="tu@email.com"
                        >
                    </div>
                    <p class="mt-2 text-xs text-gray-500">
                        <i class="fas fa-info-circle mr-1"></i>
                        Ingresa el email con el que te registraste
                    </p>
                </div>

                <!-- Bot√≥n enviar -->
                <button 
                    type="submit"
                    id="submit-btn"
                    class="w-full bg-gradient-to-r from-purple-600 to-orange-600 hover:from-purple-700 hover:to-orange-700 text-white font-bold py-4 px-6 rounded-2xl transition-all duration-300 transform hover:scale-105 hover:shadow-2xl flex items-center justify-center gap-3 group"
                >
                    <i class="fas fa-paper-plane group-hover:animate-bounce"></i>
                    Enviar Instrucciones
                </button>

                <!-- Enlaces adicionales -->
                <div class="text-center space-y-3 pt-4 border-t border-purple-500/20">
                    <a href="{% url 'authentication:web_login' %}" class="block text-sm text-gray-400 hover:text-orange-400 transition-colors duration-300">
                        <i class="fas fa-arrow-left mr-2"></i>Volver al inicio de sesi√≥n
                    </a>
                    <a href="{% url 'authentication:web_register' %}" class="block text-sm text-gray-400 hover:text-purple-400 transition-colors duration-300">
                        <i class="fas fa-user-plus mr-2"></i>¬øNo tienes cuenta? Reg√≠strate
                    </a>
                </div>
            </form>
        </div>

        <!-- Informaci√≥n adicional -->
        <div class="bg-purple-900/20 backdrop-blur-sm rounded-2xl p-6 border border-purple-500/10">
            <h3 class="text-lg font-bold text-purple-400 mb-3 flex items-center gap-2">
                <i class="fas fa-lightbulb"></i>
                ¬øC√≥mo funciona?
            </h3>
            <ul class="space-y-2 text-sm text-gray-400">
                <li class="flex items-start gap-2">
                    <i class="fas fa-check text-green-400 mt-1"></i>
                    <span>Ingresa tu correo electr√≥nico registrado</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check text-green-400 mt-1"></i>
                    <span>Te enviaremos las instrucciones para restablecer tu contrase√±a</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check text-green-400 mt-1"></i>
                    <span>Revisa tu bandeja de entrada y spam</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check text-green-400 mt-1"></i>
                    <span>Sigue el enlace del correo para crear una nueva contrase√±a</span>
                </li>
            </ul>
        </div>
    </div>
</div>

<!-- Container para notificaciones -->
<div id="notification-container" class="fixed top-20 right-4 z-50 space-y-4 max-w-md"></div>

<style>
@keyframes slideInRight {
    from {
        transform: translateX(400px);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes slideOutRight {
    from {
        transform: translateX(0);
        opacity: 1;
    }
    to {
        transform: translateX(400px);
        opacity: 0;
    }
}

.notification-enter {
    animation: slideInRight 0.5s ease-out;
}

.notification-exit {
    animation: slideOutRight 0.5s ease-in;
}

.notification-success {
    background: linear-gradient(135deg, rgba(139, 92, 246, 0.95) 0%, rgba(255, 107, 53, 0.95) 100%);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 8px 32px rgba(255, 107, 53, 0.3);
}

.notification-error {
    background: linear-gradient(135deg, rgba(220, 38, 38, 0.95) 0%, rgba(239, 68, 68, 0.95) 100%);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 8px 32px rgba(220, 38, 38, 0.3);
}
</style>

<script>
function showNotification(type, title, message, details = []) {
    const container = document.getElementById('notification-container');
    
    const notification = document.createElement('div');
    notification.className = `notification-${type} notification-enter rounded-3xl p-6 text-white shadow-2xl relative overflow-hidden`;
    
    const icon = type === 'success' 
        ? '<i class="fas fa-check-circle text-4xl"></i>' 
        : '<i class="fas fa-exclamation-circle text-4xl"></i>';
    
    let detailsHTML = '';
    if (details.length > 0) {
        detailsHTML = '<div class="space-y-2 mt-3">';
        details.forEach(detail => {
            detailsHTML += `
                <div class="flex items-start gap-2 text-sm bg-white/10 rounded-lg p-2">
                    <span class="text-lg">${detail.icon}</span>
                    <span>${detail.text}</span>
                </div>
            `;
        });
        detailsHTML += '</div>';
    }
    
    notification.innerHTML = `
        <div class="flex items-start gap-4">
            <div class="flex-shrink-0">
                ${icon}
            </div>
            <div class="flex-1">
                <h4 class="text-xl font-bold mb-1">${title}</h4>
                <p class="text-white/90 mb-2">${message}</p>
                ${detailsHTML}
            </div>
            <button onclick="this.closest('.notification-success, .notification-error').remove()" 
                    class="flex-shrink-0 hover:bg-white/20 rounded-full w-8 h-8 flex items-center justify-center transition-all">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="absolute bottom-0 left-0 w-full h-1 bg-white/30">
            <div class="h-full bg-white progress-bar"></div>
        </div>
    `;
    
    container.appendChild(notification);
    
    const progressBar = notification.querySelector('.progress-bar');
    progressBar.style.width = '100%';
    progressBar.style.transition = 'width 5s linear';
    
    setTimeout(() => {
        progressBar.style.width = '0%';
    }, 100);
    
    setTimeout(() => {
        notification.classList.remove('notification-enter');
        notification.classList.add('notification-exit');
        setTimeout(() => {
            notification.remove();
        }, 500);
    }, 5000);
}

document.getElementById('password-reset-form').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const emailInput = document.getElementById('email');
    const email = emailInput.value.trim();
    const btn = document.getElementById('submit-btn');
    
    // Validar email vac√≠o
    if (!email) {
        showNotification(
            'error',
            '‚ö†Ô∏è Campo vac√≠o',
            'Por favor ingresa tu correo electr√≥nico',
            [
                { icon: '‚úâÔ∏è', text: 'El campo de email es obligatorio' }
            ]
        );
        emailInput.focus();
        return;
    }
    
    // Validar formato de email
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        showNotification(
            'error',
            '‚ùå Email inv√°lido',
            'Por favor ingresa un correo electr√≥nico v√°lido',
            [
                { icon: 'üìß', text: 'Ejemplo: usuario@ejemplo.com' }
            ]
        );
        emailInput.focus();
        return;
    }
    
    // Deshabilitar bot√≥n
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Enviando...';
    
    // Simular env√≠o
    setTimeout(() => {
        showNotification(
            'success',
            '‚úÖ ¬°Correo enviado!',
            `Hemos enviado las instrucciones a: ${email}`,
            [
                { icon: 'üì¨', text: 'Revisa tu bandeja de entrada y spam' },
                { icon: 'üîó', text: 'Haz clic en el enlace del correo' },
                { icon: 'üîë', text: 'Crea tu nueva contrase√±a de forma segura' },
                { icon: '‚è∞', text: 'El enlace expirar√° en 24 horas' }
            ]
        );
        
        // Limpiar formulario
        emailInput.value = '';
        
        // Restaurar bot√≥n
        btn.disabled = false;
        btn.innerHTML = '<i class="fas fa-paper-plane mr-2"></i>Enviar Instrucciones';
        
        // Redirigir despu√©s de 3 segundos
        setTimeout(() => {
            window.location.href = "{% url 'authentication:web_login' %}";
        }, 3000);
    }, 1500);
});
</script>

{% endblock %}
